<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Steganography Tool</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background: #fff;
            color: #333;
        }

        header {
            background-color: #1c1c1c;
            color: #fff;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo img {
            height: 40px;
            vertical-align: middle;
        }

        nav {
            display: flex;
            align-items: center;
        }

        .menu-btn {
            display: none;
            flex-direction: column;
            cursor: pointer;
            margin-right: 20px;
        }

        .menu-btn div {
            width: 25px;
            height: 3px;
            background-color: white;
            margin: 4px;
            transition: 0.3s;
        }

        .nav-links {
            display: flex;
            list-style: none;
            padding-left: 0;
        }

        .nav-links li {
            margin: 0 10px;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            transition: background-color 0.3s;
        }

        .nav-links a:hover {
            background-color: #7D5DE6;
            border-radius: 5px;
        }

        .container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin: 50px 0;
        }

        .section {
            width: 90%;
            max-width: 600px;
            background-color: #f7f7f7;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }

        .tabs {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #4CAF50;
            border-radius: 5px;
            transition: background-color 0.3s;
            color: white;
        }

        .tab:hover, .tab.active {
            background-color: #45a049;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        input[type="file"], input[type="password"] {
            margin: 10px 0;
            padding: 10px;
            width: 100%;
            color: #000;
        }

        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #45a049;
        }

        canvas {
            margin-top: 20px;
            border: 1px solid #ccc;
        }

        a {
            display: block;
            margin-top: 20px;
            color: #4CAF50;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .menu-btn {
                display: flex;
            }

            .nav-links {
                display: none;
                position: absolute;
                top: 60px;
                right: 0;
                background-color: #1c1c1c;
                flex-direction: column;
                width: 100%;
            }

            .nav-links li {
                margin: 0;
                border-bottom: 1px solid #333;
            }

            .nav-links.active {
                display: flex;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <a href="index.html" class="site-title">
                <img src="img/myLogoCropped.png" alt="Logo">
            </a>
        </div>
        <nav>
            <div class="menu-btn" id="menu-btn">
                <div></div>
                <div></div>
                <div></div>
            </div>
            <ul id="nav-links" class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="projects.html">Projects</a></li>
                <li><a href="writeups.html">Writeups</a></li>
            </ul>
        </nav>
    </header>
    <div class="container">
        <div class="section">
            <div class="tabs">
                <div class="tab active" onclick="showTab('hide')">Hide an Image</div>
                <div class="tab" onclick="showTab('extract')">Extract an Image</div>
            </div>

            <div id="hide" class="tab-content active">
                <h2>Hide an Image</h2>
                <input type="file" id="coverImage" accept="image/*">
                <input type="file" id="secretImage" accept="image/*">
                <input type="password" id="encryptionKey" placeholder="Encryption Key (optional)">
                <button onclick="hideImage()">Hide Image</button>
                <canvas id="resultCanvas" class="canvas"></canvas>
                <a id="downloadLink" download="stego.png" style="display:none;">Download Stego Image</a>
            </div>

            <div id="extract" class="tab-content">
                <h2>Extract an Image</h2>
                <input type="file" id="stegoImage" accept="image/*">
                <input type="password" id="decryptionKey" placeholder="Decryption Key (if used)">
                <button onclick="extractImage()">Extract Image</button>
                <canvas id="extractedCanvas" class="canvas"></canvas>
            </div>
        </div>
    </div>
    <script>
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            document.getElementById(tabId).classList.add('active');
            document.querySelector(`.tab[onclick="showTab('${tabId}')"]`).classList.add('active');
        }

        document.getElementById('menu-btn').addEventListener('click', function() {
            document.getElementById('nav-links').classList.toggle('active');
        });

        function hideImage() {
            const coverImageInput = document.getElementById('coverImage');
            const secretImageInput = document.getElementById('secretImage');
            const encryptionKey = document.getElementById('encryptionKey').value;

            if (!coverImageInput.files[0] || !secretImageInput.files[0]) {
                alert('Please select both cover and secret images.');
                return;
            }

            const coverImage = new Image();
            coverImage.src = URL.createObjectURL(coverImageInput.files[0]);

            coverImage.onload = () => {
                const secretImage = new Image();
                secretImage.src = URL.createObjectURL(secretImageInput.files[0]);

                secretImage.onload = () => {
                    const canvas = document.getElementById('resultCanvas');
                    const ctx = canvas.getContext('2d');
                    canvas.width = coverImage.width;
                    canvas.height = coverImage.height;

                    ctx.drawImage(coverImage, 0, 0);
                    const coverData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(secretImage, 0, 0, canvas.width, canvas.height);
                    const secretData = ctx.getImageData(0, 0, canvas.width, canvas.height);

                    if (encryptionKey) {
                        secretData.data.set(encrypt(secretData.data, encryptionKey));
                    }

                    const encodedData = encodeImageData(coverData.data, secretData.data);
                    coverData.data.set(encodedData);
                    ctx.putImageData(coverData, 0, 0);

                    const downloadLink = document.getElementById('downloadLink');
                    downloadLink.href = canvas.toDataURL();
                    downloadLink.style.display = 'block';
                };
            };
        }

        function extractImage() {
            const stegoImageInput = document.getElementById('stegoImage');
            const decryptionKey = document.getElementById('decryptionKey').value;

            if (!stegoImageInput.files[0]) {
                alert('Please select a stego image.');
                return;
            }

            const stegoImage = new Image();
            stegoImage.src = URL.createObjectURL(stegoImageInput.files[0]);

            stegoImage.onload = () => {
                const canvas = document.getElementById('extractedCanvas');
                const ctx = canvas.getContext('2d');
                canvas.width = stegoImage.width;
                canvas.height = stegoImage.height;

                ctx.drawImage(stegoImage, 0, 0);
                const stegoData = ctx.getImageData(0, 0, canvas.width, canvas.height);

                const decodedData = decodeImageData(stegoData.data);

                if (decryptionKey) {
                    decodedData.set(decrypt(decodedData, decryptionKey));
                }

                const secretCanvas = document.getElementById('extractedCanvas');
                const secretCtx = secretCanvas.getContext('2d');
                const secretImageData = secretCtx.createImageData(canvas.width, canvas.height);
                secretImageData.data.set(decodedData);
                secretCtx.putImageData(secretImageData, 0, 0);
            };
        }

        function encodeImageData(coverData, secretData) {
            const encodedData = new Uint8ClampedArray(coverData.length);
            for (let i = 0; i < coverData.length; i += 4) {
                encodedData[i] = (coverData[i] & 0xFE) | (secretData[i] >> 7);
                encodedData[i + 1] = (coverData[i + 1] & 0xFE) | ((secretData[i] >> 6) & 1);
                encodedData[i + 2] = (coverData[i + 2] & 0xFE) | ((secretData[i] >> 5) & 1);
                encodedData[i + 3] = coverData[i + 3]; // alpha remains unchanged
            }
            return encodedData;
        }

        function decodeImageData(stegoData) {
            const decodedData = new Uint8ClampedArray(stegoData.length);
            for (let i = 0; i < stegoData.length; i += 4) {
                decodedData[i] = ((stegoData[i] & 1) << 7) |
                                 ((stegoData[i + 1] & 1) << 6) |
                                 ((stegoData[i + 2] & 1) << 5);
                decodedData[i + 3] = 255; // fully opaque
            }
            return decodedData;
        }

        function encrypt(data, key) {
            const encryptedData = new Uint8ClampedArray(data.length);
            for (let i = 0; i < data.length; i++) {
                encryptedData[i] = data[i] ^ key.charCodeAt(i % key.length);
            }
            return encryptedData;
        }

        function decrypt(data, key) {
            return encrypt(data, key); // XOR encryption is symmetric
        }
    </script>
</body>
</html>
